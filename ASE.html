<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>JDFTx: ASE Interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.3.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ASE.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ASE Interface </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>JDFTx contains a python interface class to the Atomic Simulation Environment (<a href="https://wiki.fysik.dtu.dk/ase/">https://wiki.fysik.dtu.dk/ase/</a>), developed by <a href="http://www.fysik.dtu.dk/english/Research/camd/">CAMd</a> in <a href="http://www.dtu.dk/english">DTU</a>. This provides a quick but powerful interface to many features, including <a href="https://wiki.fysik.dtu.dk/ase/ase/phonons.html">phonons</a> and <a href="https://wiki.fysik.dtu.dk/ase/ase/md.html">ab-initio molecular dynamics</a>.</p>
<p>The current implementation of the interface is as a force calculator. Potential energies and forces are implemented, but stresses are still under development.</p>
<h2>Installation </h2>
<p>The interface is available with JDFTx source code, under the scripts directory (/jdftx/scripts/ase).</p>
<p>Installing the JDFTx calculator can be done in three steps:</p>
<ol type="1">
<li><p class="startli"><b>Download and compile JDFTx</b></p>
<p class="startli">See <a href="Compiling.html">here</a> for more details on compiling JDFTx.</p>
</li>
<li><p class="startli"><b>Install Atomic Simulation Environment (ASE):</b></p>
<p class="startli">ASE is not distributed with JDFTx, and requires separate installation. See <a href="https://wiki.fysik.dtu.dk/ase/download.html">here</a> about installing ASE.</p>
</li>
<li><p class="startli"><b>Add JDFTx interface to PythonPath:</b></p>
<p class="startli">To be able to use the JDFTx interface, python needs to know where the interface file is located. This is done by adding the <em>jdftx/scripts/ase</em> to your PythonPath variable.</p>
<p class="startli">In unix based systems, the easiest way to do this is by adding the line </p>
<pre class="fragment">export PYTHONPATH=/path-to-jdftx/scripts/ase:$PYTHONPATH
</pre><p class="startli">to your ~/.bashrc or ~/.profile files. Once this is done, you can import the JDFTx calculator simply by </p>
<pre class="fragment">from JDFTx import JDFTx
</pre></li>
</ol>
<h2>Use </h2>
<p>JDFTx interface needs to know where your executable and pseudopotentials are located. This can be done at runtime by specifying paths to the class constructor, or by setting environment variables in your system.</p>
<p>A JDFTx calculator object uses variables <em>executable</em> and <em>pseudoDir</em> to find the executable and the pseudopotential directory. By default, they are set to the envionment variables $JDFTx and $JDFTx_pseudo. These can be set in the constructor or changed later.</p>
<p>The easiest way to use the interface is to set these environment variables. On Ubuntu, this can be accomplished by to accomplish this is to have the lines </p>
<pre class="fragment">export JDFTx=/path/to/jdftx
export JDFTx_pseudo=/path/to/pseudopotential/directory
</pre><p>in your ~/.bashrc or ~/.profile files.</p>
<p>On clusters with resource management programs (e.g. slurm, torque...), you can override the executable with a command that submits a job to the queue. For example, on slurm, the following would work: </p>
<pre class="fragment">calculator = JDFTx(executable='srun /path/to/jdftx')
</pre><p>Take note that when you do that, the command that submits the job (in this case, srun) should not release the shell until the job is completed. For example, in slurm, srun would work, but not sbatch.</p>
<h2>Example </h2>
<p>Below is a sample python script that uses jdftx through the ASE interfae to calculate the bond length of CO molecule using the BFGS minimization algorithm. Keep in mind that in order for the script to run, you need to modify the paths for the executable and the pseudopotentials. </p>
<pre class="fragment">from ase import Atoms
from JDFTx import *

d = 1.25
CO = Atoms('CO', positions=[(0, 0, 0), (0, 0, d)], cell=[(10,0,0),(0,10,0),(0,0,15)], pbc = [False, False, False])

# set up JDFTx calculator
jdftx_calculator = JDFTx(executable='/path/to/executable', pseudoDir='/path/to/pseudopotentials', commands={"elec-cutoff": 30})
CO.set_calculator(jdftx_calculator)

# print the initial total energy
print CO.get_potential_energy()

# perform structure optimization
from ase.optimize import BFGS
dyn = BFGS(CO)
dyn.run(fmax=0.05)
</pre><p>Output from this script is: </p>
<pre class="fragment">-583.728565039
BFGS:   0  12:37:44     -583.728565       8.6537
BFGS:   1  12:38:44     -584.230224       3.4122
BFGS:   2  12:39:45     -584.274439       2.0316
BFGS:   3  12:40:48     -584.291420       0.2329
BFGS:   4  12:41:50     -584.291665       0.0144
</pre><p>(warning: the exact energies depend on the pseudopotentials you use.)</p>
<p><a href="https://wiki.fysik.dtu.dk/ase/tutorials/tutorials.html">More examples on how to use ASE can be found here</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
