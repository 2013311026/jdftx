<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>JDFTx: IonInfo Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classIonInfo.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classIonInfo-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IonInfo Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ae7aa2fdbc2db3132a052d6ba0f4efb3c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ae7aa2fdbc2db3132a052d6ba0f4efb3c">IonWidthMethod</a> { <a class="el" href="classIonInfo.html#ae7aa2fdbc2db3132a052d6ba0f4efb3ca176ee7b07a59c63e2dcd3cffa27651e3">IonWidthEcut</a>, 
<a class="el" href="classIonInfo.html#ae7aa2fdbc2db3132a052d6ba0f4efb3ca08155658e09eaebe1f71571835e1eb70">IonWidthFFTbox</a>, 
<a class="el" href="classIonInfo.html#ae7aa2fdbc2db3132a052d6ba0f4efb3cafe0eb466e65df15af57d7e42b990bbe1">IonWidthManual</a>
 }</td></tr>
<tr class="separator:ae7aa2fdbc2db3132a052d6ba0f4efb3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aff42a9e068a392792677577bb2c3facb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aff42a9e068a392792677577bb2c3facb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setup</b> (const <a class="el" href="classEverything.html">Everything</a> &amp;)</td></tr>
<tr class="separator:aff42a9e068a392792677577bb2c3facb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e620f1ab0c64e254f4f86756bc0f099"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1e620f1ab0c64e254f4f86756bc0f099"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>printPositions</b> (FILE *) const </td></tr>
<tr class="separator:a1e620f1ab0c64e254f4f86756bc0f099"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d0615f82841077e9ed0660822389d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa8d0615f82841077e9ed0660822389d2"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#aa8d0615f82841077e9ed0660822389d2">checkPositions</a> () const </td></tr>
<tr class="memdesc:aa8d0615f82841077e9ed0660822389d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">check for overlapping atoms, return true if okay <br /></td></tr>
<tr class="separator:aa8d0615f82841077e9ed0660822389d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad08b2d205a825ba77abac2eb3c777a0c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad08b2d205a825ba77abac2eb3c777a0c"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ad08b2d205a825ba77abac2eb3c777a0c">getZtot</a> () const </td></tr>
<tr class="memdesc:ad08b2d205a825ba77abac2eb3c777a0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">get total Z of all species and atoms <br /></td></tr>
<tr class="separator:ad08b2d205a825ba77abac2eb3c777a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf2cef4237ce1a449d154b114b0e3a5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abcf2cef4237ce1a449d154b114b0e3a5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#abcf2cef4237ce1a449d154b114b0e3a5">update</a> (<a class="el" href="structEnergies.html">Energies</a> &amp;)</td></tr>
<tr class="memdesc:abcf2cef4237ce1a449d154b114b0e3a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update Vlocps, rhoIon, nChargeball, nCore and the energies dependent only on ionic positions. <br /></td></tr>
<tr class="separator:abcf2cef4237ce1a449d154b114b0e3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0bf667acc37ade16bec21abca3fe379"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae0bf667acc37ade16bec21abca3fe379"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ae0bf667acc37ade16bec21abca3fe379">ionicEnergyAndGrad</a> (<a class="el" href="structIonicGradient.html">IonicGradient</a> &amp;<a class="el" href="classIonInfo.html#a9878631a33ae059352c4a61ef2f14340">forces</a>) const </td></tr>
<tr class="memdesc:ae0bf667acc37ade16bec21abca3fe379"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the total (free) energy and calculate the ionic gradient (forces) <br /></td></tr>
<tr class="separator:ae0bf667acc37ade16bec21abca3fe379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65b6d23511d1eed78fe8ef7816c2e62e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a65b6d23511d1eed78fe8ef7816c2e62e">EnlAndGrad</a> (const <a class="el" href="classQuantumNumber.html">QuantumNumber</a> &amp;qnum, const <a class="el" href="classdiagMatrix.html">diagMatrix</a> &amp;Fq, const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;VdagCq, std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;HVdagCq) const </td></tr>
<tr class="separator:a65b6d23511d1eed78fe8ef7816c2e62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca3164f200f8780763f7ee6faefc5c8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1ca3164f200f8780763f7ee6faefc5c8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a1ca3164f200f8780763f7ee6faefc5c8">augmentOverlap</a> (const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;Cq, <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;OCq, std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; *VdagCq=0) const </td></tr>
<tr class="memdesc:a1ca3164f200f8780763f7ee6faefc5c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accumulate pseudopotential dependent contribution to the overlap in OCq. <br /></td></tr>
<tr class="separator:a1ca3164f200f8780763f7ee6faefc5c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8258442f05d9c5c326f61086998abcb4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8258442f05d9c5c326f61086998abcb4"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>augmentDensityInit</b> () const </td></tr>
<tr class="separator:a8258442f05d9c5c326f61086998abcb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a036f7e4640255916764182e7f2a45c9d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a036f7e4640255916764182e7f2a45c9d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>augmentDensitySpherical</b> (const <a class="el" href="classQuantumNumber.html">QuantumNumber</a> &amp;qnum, const <a class="el" href="classdiagMatrix.html">diagMatrix</a> &amp;Fq, const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;VdagCq) const </td></tr>
<tr class="separator:a036f7e4640255916764182e7f2a45c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2999661e1fae3fbe97f4157a69d3868"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa2999661e1fae3fbe97f4157a69d3868"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>augmentDensityGrid</b> (<a class="el" href="ScalarFieldArray_8h.html#a76a7258e8ec5efe14ca37d36fc98554c">ScalarFieldArray</a> &amp;n) const </td></tr>
<tr class="separator:aa2999661e1fae3fbe97f4157a69d3868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6caabff0119bc343f71f5510e315ebd5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6caabff0119bc343f71f5510e315ebd5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>augmentDensityGridGrad</b> (const <a class="el" href="ScalarFieldArray_8h.html#a76a7258e8ec5efe14ca37d36fc98554c">ScalarFieldArray</a> &amp;E_n, <a class="el" href="structIonicGradient.html">IonicGradient</a> *<a class="el" href="classIonInfo.html#a9878631a33ae059352c4a61ef2f14340">forces</a>=0) const </td></tr>
<tr class="separator:a6caabff0119bc343f71f5510e315ebd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab07421df1740582c9bbbec217382f9d1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab07421df1740582c9bbbec217382f9d1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>augmentDensitySphericalGrad</b> (const <a class="el" href="classQuantumNumber.html">QuantumNumber</a> &amp;qnum, const <a class="el" href="classdiagMatrix.html">diagMatrix</a> &amp;Fq, const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;VdagCq, std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;HVdagCq) const </td></tr>
<tr class="separator:ab07421df1740582c9bbbec217382f9d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a649572f1a012f72db142b2836e90c5f7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a649572f1a012f72db142b2836e90c5f7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>project</b> (const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;Cq, std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;VdagCq, <a class="el" href="classmatrix.html">matrix</a> *rotExisting=0) const </td></tr>
<tr class="separator:a649572f1a012f72db142b2836e90c5f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb2e1ca6873ba10f275ba4280d99593d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeb2e1ca6873ba10f275ba4280d99593d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>projectGrad</b> (const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;HVdagCq, const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;Cq, <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;HCq) const </td></tr>
<tr class="separator:aeb2e1ca6873ba10f275ba4280d99593d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4032d8353bad0e2c3587c5cfb63c13c1"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a4032d8353bad0e2c3587c5cfb63c13c1">rhoAtom_nMatrices</a> () const </td></tr>
<tr class="memdesc:a4032d8353bad0e2c3587c5cfb63c13c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute U corrections (DFT+U in the simplified rotationally-invariant scheme [Dudarev et al, Phys. Rev. B 57, 1505])  <a href="#a4032d8353bad0e2c3587c5cfb63c13c1">More...</a><br /></td></tr>
<tr class="separator:a4032d8353bad0e2c3587c5cfb63c13c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2c96565288643578d4a91d0ab8e6972"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2c96565288643578d4a91d0ab8e6972"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ac2c96565288643578d4a91d0ab8e6972">rhoAtom_initZero</a> (std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;rhoAtom) const </td></tr>
<tr class="memdesc:ac2c96565288643578d4a91d0ab8e6972"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize matrices of appropriate size to zero <br /></td></tr>
<tr class="separator:ac2c96565288643578d4a91d0ab8e6972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a410ac865460b60e415fc26d1bff4cf0c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a410ac865460b60e415fc26d1bff4cf0c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a410ac865460b60e415fc26d1bff4cf0c">rhoAtom_calc</a> (const std::vector&lt; <a class="el" href="classdiagMatrix.html">diagMatrix</a> &gt; &amp;F, const std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; &amp;C, std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;rhoAtom) const </td></tr>
<tr class="memdesc:a410ac865460b60e415fc26d1bff4cf0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute atomic density matrices <br /></td></tr>
<tr class="separator:a410ac865460b60e415fc26d1bff4cf0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39884c5be3b656f6e30a5f565facbd1d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a39884c5be3b656f6e30a5f565facbd1d"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a39884c5be3b656f6e30a5f565facbd1d">rhoAtom_computeU</a> (const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;rhoAtom, std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;U_rhoAtom) const </td></tr>
<tr class="memdesc:a39884c5be3b656f6e30a5f565facbd1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">compute U energy and gradient w.r.t atomic density matrices <br /></td></tr>
<tr class="separator:a39884c5be3b656f6e30a5f565facbd1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86fbebb5d6ca259ee166c9ab7341be69"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86fbebb5d6ca259ee166c9ab7341be69"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a86fbebb5d6ca259ee166c9ab7341be69">rhoAtom_grad</a> (const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;Cq, const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;U_rhoAtom, <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;HCq) const </td></tr>
<tr class="memdesc:a86fbebb5d6ca259ee166c9ab7341be69"><td class="mdescLeft">&#160;</td><td class="mdescRight">propagate U_rhoAtom to wavefunction gradient (per k-point to enable band structure) <br /></td></tr>
<tr class="separator:a86fbebb5d6ca259ee166c9ab7341be69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade05a0f025c8af8c1f4838338f69f48d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ade05a0f025c8af8c1f4838338f69f48d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ade05a0f025c8af8c1f4838338f69f48d">rhoAtom_forces</a> (const std::vector&lt; <a class="el" href="classdiagMatrix.html">diagMatrix</a> &gt; &amp;F, const std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; &amp;C, const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;U_rhoAtom, <a class="el" href="structIonicGradient.html">IonicGradient</a> &amp;<a class="el" href="classIonInfo.html#a9878631a33ae059352c4a61ef2f14340">forces</a>) const </td></tr>
<tr class="memdesc:ade05a0f025c8af8c1f4838338f69f48d"><td class="mdescLeft">&#160;</td><td class="mdescRight">propagate U_rhoAtom to forces <br /></td></tr>
<tr class="separator:ade05a0f025c8af8c1f4838338f69f48d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f50ca80d76ed665fc64e481f6b843a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17f50ca80d76ed665fc64e481f6b843a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a17f50ca80d76ed665fc64e481f6b843a">rhoAtom_getV</a> (const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;Cq, const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;U_rhoAtom, std::vector&lt; <a class="el" href="classColumnBundle.html">ColumnBundle</a> &gt; &amp;psi, std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;M) const </td></tr>
<tr class="memdesc:a17f50ca80d76ed665fc64e481f6b843a"><td class="mdescLeft">&#160;</td><td class="mdescRight">get DFT+U Hamiltonian basis (atomic orbitals) and matrices <br /></td></tr>
<tr class="separator:a17f50ca80d76ed665fc64e481f6b843a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc205faf6fcd58105b0b5b86b9fc8173"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc205faf6fcd58105b0b5b86b9fc8173"></a>
<a class="el" href="classColumnBundle.html">ColumnBundle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#abc205faf6fcd58105b0b5b86b9fc8173">rHcommutator</a> (const <a class="el" href="classColumnBundle.html">ColumnBundle</a> &amp;Y, int iDir) const </td></tr>
<tr class="memdesc:abc205faf6fcd58105b0b5b86b9fc8173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply commutator operator [r_iDir,H] = D_iDir + nonlocal corrections. <br /></td></tr>
<tr class="separator:abc205faf6fcd58105b0b5b86b9fc8173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcaef7d50a46f357f1e154ded26ce4cf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adcaef7d50a46f357f1e154ded26ce4cf"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#adcaef7d50a46f357f1e154ded26ce4cf">nAtomicOrbitals</a> () const </td></tr>
<tr class="memdesc:adcaef7d50a46f357f1e154ded26ce4cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of atomic orbitals. <br /></td></tr>
<tr class="separator:adcaef7d50a46f357f1e154ded26ce4cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa70ce33937a962521cc6e729c42a4b19"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa70ce33937a962521cc6e729c42a4b19"></a>
<a class="el" href="classColumnBundle.html">ColumnBundle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#aa70ce33937a962521cc6e729c42a4b19">getAtomicOrbitals</a> (int q, bool applyO, int extraCols=0) const </td></tr>
<tr class="memdesc:aa70ce33937a962521cc6e729c42a4b19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all atomic orbitals of a given state number q, optionally with operator O pre-applied (with room for extra columns if specified) <br /></td></tr>
<tr class="separator:aa70ce33937a962521cc6e729c42a4b19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a76c1141d6fa9065963c2cfc4dd632094"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76c1141d6fa9065963c2cfc4dd632094"></a>
std::vector&lt; std::shared_ptr&lt; <a class="el" href="classSpeciesInfo.html">SpeciesInfo</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a76c1141d6fa9065963c2cfc4dd632094">species</a></td></tr>
<tr class="memdesc:a76c1141d6fa9065963c2cfc4dd632094"><td class="mdescLeft">&#160;</td><td class="mdescRight">list of ionic species <br /></td></tr>
<tr class="separator:a76c1141d6fa9065963c2cfc4dd632094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8ca3d54cc38eb92e776ff9a124c6b73"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad8ca3d54cc38eb92e776ff9a124c6b73"></a>
std::vector&lt; <a class="el" href="string_8h.html#a8365eedfd1b02393873732bfaab5c018">string</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ad8ca3d54cc38eb92e776ff9a124c6b73">pspFilenamePatterns</a></td></tr>
<tr class="memdesc:ad8ca3d54cc38eb92e776ff9a124c6b73"><td class="mdescLeft">&#160;</td><td class="mdescRight">list of wildcards for pseudopotential sets <br /></td></tr>
<tr class="separator:ad8ca3d54cc38eb92e776ff9a124c6b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a051a3c07e2544b38fcd1de3ecd4ecd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a051a3c07e2544b38fcd1de3ecd4ecd"></a>
CoordsType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a9a051a3c07e2544b38fcd1de3ecd4ecd">coordsType</a></td></tr>
<tr class="memdesc:a9a051a3c07e2544b38fcd1de3ecd4ecd"><td class="mdescLeft">&#160;</td><td class="mdescRight">coordinate system for ionic positions etc. <br /></td></tr>
<tr class="separator:a9a051a3c07e2544b38fcd1de3ecd4ecd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad56b2c7a36dc7eb1add127d9441285f3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad56b2c7a36dc7eb1add127d9441285f3"></a>
ForcesOutputCoords&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ad56b2c7a36dc7eb1add127d9441285f3">forcesOutputCoords</a></td></tr>
<tr class="memdesc:ad56b2c7a36dc7eb1add127d9441285f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">coordinate system to print forces in <br /></td></tr>
<tr class="separator:ad56b2c7a36dc7eb1add127d9441285f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ba4776a7f258e6609a5c237fe60d2e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a14ba4776a7f258e6609a5c237fe60d2e"></a>
coreOverlapCheck&#160;</td><td class="memItemRight" valign="bottom"><b>coreOverlapCondition</b></td></tr>
<tr class="separator:a14ba4776a7f258e6609a5c237fe60d2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d66570e234eb46b297246d4f079eafb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a2d66570e234eb46b297246d4f079eafb">vdWenable</a></td></tr>
<tr class="memdesc:a2d66570e234eb46b297246d4f079eafb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check method used for determining whether pseudopotential cores overlap.  <a href="#a2d66570e234eb46b297246d4f079eafb">More...</a><br /></td></tr>
<tr class="separator:a2d66570e234eb46b297246d4f079eafb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5ab9fe8aa095250aaf78fe83e84c24"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aec5ab9fe8aa095250aaf78fe83e84c24"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#aec5ab9fe8aa095250aaf78fe83e84c24">vdWscale</a></td></tr>
<tr class="memdesc:aec5ab9fe8aa095250aaf78fe83e84c24"><td class="mdescLeft">&#160;</td><td class="mdescRight">If non-zero, override the default scale parameter. <br /></td></tr>
<tr class="separator:aec5ab9fe8aa095250aaf78fe83e84c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9878631a33ae059352c4a61ef2f14340"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9878631a33ae059352c4a61ef2f14340"></a>
<a class="el" href="structIonicGradient.html">IonicGradient</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a9878631a33ae059352c4a61ef2f14340">forces</a></td></tr>
<tr class="memdesc:a9878631a33ae059352c4a61ef2f14340"><td class="mdescLeft">&#160;</td><td class="mdescRight">forces at current atomic positions <br /></td></tr>
<tr class="separator:a9878631a33ae059352c4a61ef2f14340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be0d552d1d98e0ee9d80ad16105c22d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9be0d552d1d98e0ee9d80ad16105c22d"></a>
<a class="el" href="group__griddata.html#ga6e08b08fea5bf3bca91972c6e49d4547">ScalarFieldTilde</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a9be0d552d1d98e0ee9d80ad16105c22d">Vlocps</a></td></tr>
<tr class="memdesc:a9be0d552d1d98e0ee9d80ad16105c22d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Net local pseudopotential. <br /></td></tr>
<tr class="separator:a9be0d552d1d98e0ee9d80ad16105c22d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ed20aaa32bf6a27edacc5596604ecc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac5ed20aaa32bf6a27edacc5596604ecc"></a>
<a class="el" href="group__griddata.html#ga6e08b08fea5bf3bca91972c6e49d4547">ScalarFieldTilde</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ac5ed20aaa32bf6a27edacc5596604ecc">rhoIon</a></td></tr>
<tr class="memdesc:ac5ed20aaa32bf6a27edacc5596604ecc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total ionic charge density (with width ionWidth, used for interactions with fluid) <br /></td></tr>
<tr class="separator:ac5ed20aaa32bf6a27edacc5596604ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a970313db61e8c35d23e725cdc7de1b4b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a970313db61e8c35d23e725cdc7de1b4b"></a>
<a class="el" href="group__griddata.html#ga6e08b08fea5bf3bca91972c6e49d4547">ScalarFieldTilde</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a970313db61e8c35d23e725cdc7de1b4b">nChargeball</a></td></tr>
<tr class="memdesc:a970313db61e8c35d23e725cdc7de1b4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extra electron density around ionic cores to keep fluid out (DEPRECATED) <br /></td></tr>
<tr class="separator:a970313db61e8c35d23e725cdc7de1b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e2ab1bebc837ec5506df215c285de83"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e2ab1bebc837ec5506df215c285de83"></a>
<a class="el" href="group__griddata.html#gaba3dacad6ffc23d9625d87ea805b2bd9">ScalarField</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a0e2ab1bebc837ec5506df215c285de83">nCore</a></td></tr>
<tr class="memdesc:a0e2ab1bebc837ec5506df215c285de83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core electron density for partial (nonlinear) core correction. <br /></td></tr>
<tr class="separator:a0e2ab1bebc837ec5506df215c285de83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8c9e61990a9f1d31897823a43cc17ad"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab8c9e61990a9f1d31897823a43cc17ad"></a>
<a class="el" href="group__griddata.html#gaba3dacad6ffc23d9625d87ea805b2bd9">ScalarField</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#ab8c9e61990a9f1d31897823a43cc17ad">tauCore</a></td></tr>
<tr class="memdesc:ab8c9e61990a9f1d31897823a43cc17ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Model for the KE density of the core (TF+vW applied to nCore) (used by meta-GGAs) <br /></td></tr>
<tr class="separator:ab8c9e61990a9f1d31897823a43cc17ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9bc7f4768a644e153ddd9b84b07426"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a9bc7f4768a644e153ddd9b84b07426"></a>
enum <a class="el" href="classIonInfo.html#ae7aa2fdbc2db3132a052d6ba0f4efb3c">IonInfo::IonWidthMethod</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a0a9bc7f4768a644e153ddd9b84b07426">ionWidthMethod</a></td></tr>
<tr class="memdesc:a0a9bc7f4768a644e153ddd9b84b07426"><td class="mdescLeft">&#160;</td><td class="mdescRight">method for determining ion charge width <br /></td></tr>
<tr class="separator:a0a9bc7f4768a644e153ddd9b84b07426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374553bf484839a6613c83fc0e7f964f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a374553bf484839a6613c83fc0e7f964f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIonInfo.html#a374553bf484839a6613c83fc0e7f964f">ionWidth</a></td></tr>
<tr class="memdesc:a374553bf484839a6613c83fc0e7f964f"><td class="mdescLeft">&#160;</td><td class="mdescRight">width for gaussian representation of nuclei <br /></td></tr>
<tr class="separator:a374553bf484839a6613c83fc0e7f964f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b93a4b4614fcbed78b49cbf3cf41c9d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5b93a4b4614fcbed78b49cbf3cf41c9d"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>shouldPrintForceComponents</b></td></tr>
<tr class="separator:a5b93a4b4614fcbed78b49cbf3cf41c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="ae7aa2fdbc2db3132a052d6ba0f4efb3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classIonInfo.html#ae7aa2fdbc2db3132a052d6ba0f4efb3c">IonInfo::IonWidthMethod</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ae7aa2fdbc2db3132a052d6ba0f4efb3ca176ee7b07a59c63e2dcd3cffa27651e3"></a>IonWidthEcut&#160;</td><td class="fielddoc">
<p>determine ion width from Ecut </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ae7aa2fdbc2db3132a052d6ba0f4efb3ca08155658e09eaebe1f71571835e1eb70"></a>IonWidthFFTbox&#160;</td><td class="fielddoc">
<p>determine ion width from grid spacing </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ae7aa2fdbc2db3132a052d6ba0f4efb3cafe0eb466e65df15af57d7e42b990bbe1"></a>IonWidthManual&#160;</td><td class="fielddoc">
<p>manually specify the ion width </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a65b6d23511d1eed78fe8ef7816c2e62e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double IonInfo::EnlAndGrad </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classQuantumNumber.html">QuantumNumber</a> &amp;&#160;</td>
          <td class="paramname"><em>qnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdiagMatrix.html">diagMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>Fq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>VdagCq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classmatrix.html">matrix</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>HVdagCq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the non-local pseudopotential energy due to a single state. Optionally accumulate the corresponding electronic gradient in HCq and ionic gradient in forces </p>

</div>
</div>
<a class="anchor" id="a4032d8353bad0e2c3587c5cfb63c13c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t IonInfo::rhoAtom_nMatrices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute U corrections (DFT+U in the simplified rotationally-invariant scheme [Dudarev et al, Phys. Rev. B 57, 1505]) </p>
<p>number of matrices in rhoAtom array </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a2d66570e234eb46b297246d4f079eafb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IonInfo::vdWenable</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check method used for determining whether pseudopotential cores overlap. </p>
<p>whether vdW pair-potential corrections are enabled </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>electronic/<a class="el" href="IonInfo_8h_source.html">IonInfo.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classIonInfo.html">IonInfo</a></li>
    <li class="footer">Generated on Thu Jan 26 2017 12:51:46 for JDFTx by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
