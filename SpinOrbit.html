<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>JDFTx: Spin-orbit coupling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.2.1</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('SpinOrbit.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Spin-orbit coupling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="RelBandStruct.png" alt="RelBandStruct.png"/>
</div>
<p>Most density-functional theory calculations are based in non-relativistic quantum mechanics, where spin decouples completely from the spatial degrees of freedom and only enter in the orbital occupations. Far from the atoms, the electron velocities are indeed much smaller than the speed of light and the non-relativistic approximation is valid. This is however no longer true close to the nuclei for electrons with non-zero angular momentum. Importantly, even valence electrons (with l &gt; 0) in heavy atoms pick up relativsitic effects - especially spin-orbit coupling - from the regions of space close to the nuclei. This tutorial demonstrates the effect of spin-orbit coupling on the band structure of metallic platinum.</p>
<p>In plane-wave calculations using pseudopotentials, these relativistic effects can be built into the pseudopotentials. The GBRV pseudopotentials we have used so far do not have relativistic versions available, so we will use another pseudopotential from the <a href="http://www.quantum-espresso.org/pseudopotentials">Quantum Espresso pseudopotential library</a>. Download <a href="http://www.quantum-espresso.org/wp-content/uploads/upf_files/Pt.rel-pbe-n-rrkjus_psl.0.1.UPF">this relativistic pseudopotential</a>, and also <a href="http://www.quantum-espresso.org/wp-content/uploads/upf_files/Pt.pbe-n-rrkjus_psl.0.1.UPF">this conventional non-relativistic pseudopotential</a>, into your current working directory. We will use a different non-relativistic pseudopotential as well to compare with and identify the relativistic effects, and for this we will use the downloaded one instead of GBRV because its generation parameters are much closer to the relativistic one and we will see less discrepancies simply due to pseudopotential differences.</p>
<p>You should now have two UPF pseudopotential files in your current directory: </p>
<pre class="fragment">Pt.rel-pbe-n-rrkjus_psl.0.1.UPF   #the relativistic one
Pt.pbe-n-rrkjus_psl.0.1.UPF       #the non-relativistic one
</pre><p>Let's start with a non-relativistic band-structure calculation of platinum, exactly as in in the <a class="el" href="Metals.html">Metals</a> tutorial, but with the new pseudopotential: </p>
<pre class="fragment">#Save the following to common.in:
lattice face-centered Cubic 7.41
ion-species Pt.pbe-n-rrkjus_psl.0.1.UPF
elec-cutoff 20 200    #Above UPF suggests higher charge-density cutoff than GBRV
ion Pt  0 0 0  0

#Save the following to totalE.in:
include common.in
dump End ElecDensity
dump-name totalE.$VAR
kpoint-folding 12 12 12
elec-smearing Fermi 0.01
electronic-SCF

#Save the following to bandstruct.in
include common.in
include bandstruct.kpoints
fix-electron-density totalE.$VAR
elec-n-bands 9
dump End BandEigs
dump-name bandstruct.$VAR
</pre><p>Use the bandstructKpoints script to generate a k-point path and plot script as described in the <a class="el" href="BandStructure.html">Band structure calculations</a> tutorial, and run the total energy and band structure calculations using: </p>
<pre class="fragment">mpirun -n 4 jdftx -i totalE.in |  tee totalE.out
mpirun -n 4 jdftx -i bandstruct.in |  tee bandstruct.out
</pre><p>Edit the plot script to reference energies relative to the Fermi level and in eV, and you should get a band structure very similar to the one in the <a class="el" href="Metals.html">Metals</a> tutorial, with only minor differences due to the pseudopotential.</p>
<p>Now to perform the relativistic (spin-orbit) calculations, similarly make three input files, with the important differences annotated: </p>
<pre class="fragment">#Save the following to common-rel.in:
lattice face-centered Cubic 7.41
ion-species Pt.rel-pbe-n-rrkjus_psl.0.1.UPF   #Different pseudopotential file
elec-cutoff 20 200
ion Pt  0 0 0  0
spintype spin-orbit                           #Relativistic spin type

#Save the following to totalE-rel.in:
include common-rel.in
dump End ElecDensity
dump-name totalE-rel.$VAR
kpoint-folding 12 12 12
elec-smearing Fermi 0.01
electronic-SCF

#Save the following to bandstruct-rel.in
include common-rel.in
include bandstruct.kpoints
fix-electron-density totalE-rel.$VAR
elec-n-bands 18                               #Spinorial: twice as many bands
dump End BandEigs
dump-name bandstruct-rel.$VAR
</pre><p>and run the calculations using: </p>
<pre class="fragment">mpirun -n 4 jdftx -i totalE-rel.in |  tee totalE-rel.out
mpirun -n 4 jdftx -i bandstruct-rel.in |  tee bandstruct-rel.out
</pre><p>Compare the relativistic and non-relativistic output files. The most important difference is that the number of bands is double in the relativistic calculation since the spin degrees of freedom must now be treated explicitly. Additionally, the code also needs to store two spinor components for each wave-function, which along with the band doubling, makes the net memory usage about four times as large as the corresponding non-relativistic calculation. The time taken for the calculations also increases by a similar factor.</p>
<p>Edit the previous bandstructure plot script to overlay bandstruct-rel.eigenvals, and obtain the plot shown below and at the top of this page. (Hint: you will need to duplicate and edit the nCols and formatString lines in bandstruct.plot.) Notice that the lowest band is unaffected by spin-orbit coupling: this is because this band is dominated by s character (l = 0) and hence has negligible orbital angular momentum. Strong splittings close to 1 eV are observable near the Gamma and L points approximately 4 eV below the Fermi level, and near the X point close to the Fermi level. Spin-orbit coupling usually does not significantly impact geometries and reaction energies, but has a very strong influence on optical properties of materials with heavy elements, because these properties depend directly on energy level spacings.</p>
<div class="image">
<img src="RelBandStruct.png" alt="RelBandStruct.png"/>
</div>
<p>With this, we have explored three of the four options in <a class="el" href="CommandSpintype.html">spintype</a>. For non-relativistic calculations, no-spin and z-spin correspond to spin-unpolarized and spin-polarized calculations respectively. Analgously, spin-orbit specifies unpolarized relativistic calculations whereas the fourth mode, vector-spin, specifies polarized relativistic calculations. The number of bands and k-vectors will be identical between spin-orbit and vector-spin calculations since all the spin degrees of freedom are treated explicitly anyway. Additionally, in vector-spin mode, you can specify <a class="el" href="CommandInitialMagneticMoments.html">initial-magnetic-moments</a> to initialize the magnetizations on each atom, which are now all vectors with directions (and not just + / - as in z-spin mode). Correspondingly, all magnetization output in the code, such as in the FillingsUpdate lines and in the Lowdin analysis, report a vector direction in addition to magnitude.</p>
<p>Exercise: reproduce the <a href="DFTplusU.html">previous tutorial</a> with spins along the x-axis and then again with spins along the y-axis using vector-spin <a class="el" href="CommandSpintype.html">spintype</a>. Note that you can continue to use the non-relativistic GBRV pseudopotentials for this exercise, and you should then get the same answers irrespective of overall spin axis direction (since spin and spatial motion are decoupled). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jun 17 2017 19:00:07 for JDFTx by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
